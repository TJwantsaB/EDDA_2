---
title: "Assignment 2"
author: "Lukas Unruh, Teije Langelaan, Gidon Quint"
date: "`r format(Sys.Date(), '%d %B, %Y')`"
output: 
  pdf_document:
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(333)
library(lme4)
library(Matrix)
library(carData)
options(digits=3)
```

# Exercise 1

```{r}
fruitfly_data=read.table(file="fruitflies.txt",header=TRUE)
```

## Lukas)

### a)

### b)

### c)

### d)

### e)

## Gid)

### a)

### b)

### c)

### d)

### e)

## TJ)

### a)

### b)

### c)

### d)

### e)

# Exercise 2

```{r}
birthweight_data=read.csv(file="Birthweight.csv",header=TRUE)
```

## Lukas)

### a)

### b)

### c)

### d)

### e)

### f)

### g)

### h)

### i)

## Gid)

### a)

### b)

### c)

### d)

### e)

### f)

### g)

### h)

### i)

## TJ)
### a)

```{r}
# Assuming birthweight_data is your dataset
summary(birthweight_data)

# Fit a linear model
TJ_BW <- lm(Birthweight ~ Length + Headcirc + Gestation + mage + mnocig + mheight + mppwt + fage + fedyrs + fnocig + fheight, data=birthweight_data)

# Plot diagnostics for influential points
par(mfrow=c(2,2))
plot(TJ_BW, which=1:4) # Plots for residuals, leverage, etc.
round(cooks.distance(TJ_BW),2)


```

Upon inspection of Cook's distances, we conclude that there are no influence points in the data set, as no observation has a Cook's distance greater than 1.

```{r}
predictors <- birthweight_data[, c("Length", "Headcirc", "Gestation", "mage", "mnocig", "mheight", "mppwt", "fage", "fedyrs", "fnocig", "fheight")]
print(cor(predictors))

vif_values <- vif(TJ_BW)
print(vif_values)
```

Upon inspection of correlation matrix, we note that variables mage and fage appear to be highly correlated (0.806), however their VIF values are under 5, therefore we conclude that the model has no problem of collinearity.

### b)
```{r}
summary(TJ_BW)
TJ_BW_reduced <- step(TJ_BW, direction = "backward")
summary(TJ_BW_reduced)
```
Using the step-down approach we arrived at the following model: Birthweight ~ 
Length + Headcirc + Gestation + mage + mppwt + fheight with R-squared: 0.757

```{r}
plot(TJ_BW_reduced, which = 1)

qqnorm(residuals(TJ_BW_reduced))
qqline(residuals(TJ_BW_reduced))
shapiro.test(residuals(TJ_BW_reduced))
```
In the residuals vs fitted plot, the pattern from 3.0 to 3.5 could hint at 
non-linearity, adding polynomial or interaction terms might improve fit. Upon
further inspection of the QQ-plot and shapiro-Wilk test we conclude that the
assumption of normally distributed residuals is not met.

### c)
```{r}
# Calculate the average values for the predictors
avg_data <- data.frame(
  Length = mean(birthweight_data$Length, na.rm = TRUE),
  Headcirc = mean(birthweight_data$Headcirc, na.rm = TRUE),
  Gestation = mean(birthweight_data$Gestation, na.rm = TRUE),
  mage = mean(birthweight_data$mage, na.rm = TRUE),
  mppwt = mean(birthweight_data$mppwt, na.rm = TRUE),
  fheight = mean(birthweight_data$fheight, na.rm = TRUE)
)

# Assuming your model is named 'TJ_BW_reduced' and is already fitted with the correct formula
# Predict the Birthweight for the average values with 95% confidence interval
confidence_interval <- predict(TJ_BW_reduced, newdata = avg_data, interval = "confidence", level = 0.95)

# Predict the Birthweight for the average values with 95% prediction interval
prediction_interval <- predict(TJ_BW_reduced, newdata = avg_data, interval = "prediction", level = 0.95)

# View the results
confidence_interval
prediction_interval
```

### d)

### e)

### f)

### g)

### h)

### i)

# Exercise 3

```{r}
awards_data=read.table(file="awards.txt",header=TRUE)
```

## Lukas)

### a)

### b)

### c)

## Gid)

### a)

### b)

### c)

## TJ)

### a)

### b)

### c)
